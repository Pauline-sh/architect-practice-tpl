#### ID: ADR-1

#### Дата: 08.10.23

#### Статус: Принято

#### Участники:
Полина Шестакова

#### Решения:
Модульная архитектура, которая разделяет задачи и позволяет легко расширять функциональность. Система будет состоять из следующих компонентов:

- Сервер управления отправкой сообщений: 
    сервер, который умеет
    - получать сообщения от других систем через системный интерфейс
    - позволяет отправлять сообщение по всем каналам группе клиентов
    - позволяет отправлять сообщение адресно в каждый канал связи конкретным адресатам
    - добавляет сообщения в очередь на отправку согласно настройкам каналов
    - менять настройки отправления сообщений в реальном времени

- Очередь сообщений:
    очередь сообщений для отправки в разных каналах. Позволяет обрабатывать сообщения в порядке очереди и учитывать пропускные лимиты каналов

- Компоненты для предобработки и отправки сообщений в разных каналах:
    должны уметь отправлять сообщения в свой канал связи
    - SMS:
        предусматривает ограничение количества символов в СМС
    - Email:
        предусматривает возможность попадания email в спам
    - Push:
        предусматривает возможность отправки пушей на разные платформы (iOS, Android, Web)
    
- Хранилище: 
    база данных, которая хранит информацию об учетных записях пользователей из других подсистем и настроек сообщений для них

Для контейнеризации компонентов используем Docker. Это популярное решения с большой поддержкой коммьюнити. В дальнейшем для оркестрации системы может использоваться Kubernetes, но на данный момент это необязательно.

Альтернатива здесь, это использовать монолитную архитектуру, но число разных каналов для отправки оповещений наводит на мысль, что компоненты для этих каналов должны быть независимы и иметь возможность легкого отключения и подключения. Микросервисы лучше решат данную задачу.

#### Контекст:
Нам необходимо разработать систему электронной почты, которая позволяет отправлять сообщения по разным каналам связи -- смс, пуш, имейл. Система должна предусматривать возможность интеграции с другими системами с помощью API. Также система должна принимать от пользователя системы настройки по каждому каналу связи для рассылки уведомлений (вкл./выкл., адрес/номер/логин) и учитывать их при последующих рассылках.

#### Последствия:

#### Положительные:
* позволяет легко добавлять новые функции, например, новые каналы связи
* позволяет масштабировать систему при росте нагрузки, добавляя новые сервера для отправки сообщений
* отказоустойчивость системы - выход из строя одного компонента не обязательно приводит к полной остановке системы

#### Отрицательные:
* требует больше времени на разработку
* требует больше ресурсов для сопровождения и поддержки
* нужна команда разработки с опытом разработки микросервисной архитектуры


